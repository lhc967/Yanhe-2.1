import{_ as pe,u as ve,a as be,L as me,o as ye,c as o,d as e,w as K,t as a,e as R,f as d,j as I,C,k as F,T as X,H as y,I as h,n as p,D as H,V as he,r as n,q as fe,m as J,E as _,g as Y,p as ge,h as _e,i,G as we,F as ke,W as $e,X as Ce}from"./index-CVi_qNo8.js";const xe={class:"course-player-page"},Me={class:"navbar navbar-expand-lg fixed-top custom-navbar"},Te={class:"container-fluid px-4"},Se={class:"d-flex align-items-center ms-auto gap-3"},Pe=["src"],ze={key:0,class:"container py-4 main-container"},Ve={key:1,class:"container py-4 main-container"},Be={class:"row g-4"},Ie={class:"col-lg-8"},Fe={class:"video-container shadow-sm",id:"videoArea"},He={key:0,class:"lock-overlay d-flex"},Ee={class:"fw-bold"},Ne={class:"text-white-50 mb-4"},Ae={class:"btn btn-link text-white small mt-2"},Re={key:1,class:"player-wrapper"},Ue=["src"],De={key:0,class:"subtitle-layer"},Le={key:0,class:"sub-cn"},je={key:1,class:"sub-en"},Ge={class:"card mt-3 border-0 shadow-sm tool-card"},Oe={class:"card-body d-flex align-items-center gap-2 py-2 flex-wrap"},qe={class:"fw-bold small text-muted me-2"},Qe={class:"dropdown"},We={class:"btn btn-light btn-sm border dropdown-toggle",type:"button","data-bs-toggle":"dropdown"},Ke={class:"dropdown-menu p-2 shadow",style:{"min-width":"240px"}},Xe={class:"mb-2 text-muted small px-2"},Je={class:"d-flex gap-1 flex-wrap px-2"},Ye=["onClick"],Ze={key:0,class:"control-bar mt-3 p-3 bg-white rounded shadow-sm d-flex gap-3 align-items-center flex-wrap"},et={class:"dropdown"},tt={class:"btn btn-light btn-sm dropdown-toggle",type:"button","data-bs-toggle":"dropdown"},st={class:"dropdown-menu"},lt=["onClick"],at={class:"btn-group btn-group-sm"},ot={class:"form-check form-switch ms-auto"},it={class:"form-check-label small",for:"subSwitch"},nt={class:"mt-4"},rt={class:"fw-bold"},dt={class:"d-flex gap-3 text-muted small mt-2"},ut={class:"fw-bold mt-4"},ct={class:"bg-light p-3 rounded small text-secondary"},pt={class:"col-lg-4"},vt={class:"playlist-card"},bt={class:"playlist-header"},mt={class:"fw-bold m-0"},yt={class:"video-tabs"},ht=["onClick"],ft={class:"chapter-list"},gt=["onClick"],_t={class:"small fw-bold mb-1 text-dark"},wt={class:"text-muted",style:{"font-size":"11px"}},kt={class:"text-end"},$t={key:0,class:"tag-free"},Ct={key:1,class:"tag-vip"},xt={key:2,class:"tag-paid"},Mt={class:"ai-float-btn"},Tt={class:"card shadow-lg ai-chat-box"},St={class:"card-header bg-primary text-white d-flex justify-content-between align-items-center",style:{"border-radius":"16px 16px 0 0"}},Pt={class:"fw-bold"},zt={class:"card-body bg-light overflow-auto",ref:"chatBody"},Vt={class:"card-footer bg-white"},Bt={class:"input-group"},It=["placeholder"],Ft={class:"fw-bold mb-2"},Ht={class:"d-flex flex-column gap-2"},Et=["name","value","onUpdate:modelValue"],Nt={class:"d-flex justify-content-between align-items-center"},At={key:0,class:"fw-bold text-primary"},Rt=["disabled"],Ut={__name:"CoursePlayerView",setup(Dt){const{t:v,locale:U}=ve(),D=_e(),L=fe(),m=be(),j=n(!0),P=n(!1),E=n(!1),w=n(""),z=n("all"),x=n(null),N=n("https://media.w3.org/2010/05/sintel/trailer.mp4"),r=Y({speed:1,showSubtitle:!0,subMode:"BOTH"}),M=n(!1),V=n(0),f=n(!1),G=n(""),Z=["ā","á","ǎ","à","ō","ó","ǒ","ò","ē","é","ě","è","ī","í","ǐ","ì"],T=n([]),u=n({}),k=n([]),A=n([]),O=n([]),B=Y({cn:"",en:""}),S=n({}),g=n(null),q=()=>{const t=U.value==="en";T.value=[{id:1,title:t?"01. Intro: Negotiation Mindset":"01. 导论：中国人的谈判思维",type:"grammar",isPaid:!1,unlocked:!0,duration:"15:00",price:0},{id:2,title:t?"02. Vocab: Quoting & Bargaining":"02. 核心词汇：报价与还价",type:"grammar",isPaid:!1,unlocked:!0,duration:"22:30",price:0},{id:3,title:t?"03. Scenario: First Meeting":"03. 情景模拟：初次见面寒暄",type:"scenario",isPaid:!0,unlocked:!1,duration:"10:45",price:99},{id:4,title:t?"04. Scenario: Toasting Etiquette":"04. 情景模拟：酒桌上的博弈",type:"scenario",isPaid:!0,unlocked:!1,duration:"18:20",price:99},{id:5,title:t?"05. Culture: Mianzi (Face)":"05. 文化：面子工程",type:"culture",isPaid:!0,unlocked:!1,duration:"12:00",price:199},{id:6,title:t?"06. Contract Analysis":"06. 合同条款深度解析",type:"grammar",isPaid:!0,unlocked:!1,duration:"35:00",price:199}];const s=u.value.id||1;u.value=T.value.find(c=>c.id===s)||T.value[0],O.value=t?["How to politely refuse alcohol?","Toasting order and phrasing",'Application of "Giving Face" in business']:["如何委婉地拒绝劝酒？ (Polite Refusal)","敬酒的顺序与措辞 (Toasting Etiquette)","“给面子”在商务谈判中的实际应用。"],B.cn="示例：商务谈判中的“给面子”非常重要。",B.en='Example: "Giving face" is crucial.',A.value=[{id:1,title:t?'What does "Giving Face" mean?':'商务谈判中，"Giving Face" 指的是？',correct:"B",options:t?[{val:"A",label:"Giving Money"},{val:"B",label:"Respect/Honor"},{val:"C",label:"Face to Face"}]:[{val:"A",label:"给钱"},{val:"B",label:"给面子/尊重"},{val:"C",label:"面对面"}]},{id:2,title:t?"Which hand to use for business cards?":"初次见面交换名片应该用哪只手？",correct:"A",options:t?[{val:"A",label:"Both Hands"},{val:"B",label:"One Hand"},{val:"C",label:"Any"}]:[{val:"A",label:"双手"},{val:"B",label:"单手"},{val:"C",label:"随意"}]}],(k.value.length===0||k.value.length===1)&&(k.value=[{role:"ai",text:v("player.ai.welcome")}])};me(U,q),ye(()=>{q(),setTimeout(()=>{j.value=!1,f.value=m.favorites.includes(parseInt(L.params.id)||1),m.addHistory({id:1,title:"商务汉语谈判技巧"})},800)});const ee=ge(()=>z.value==="all"?T.value:T.value.filter(t=>t.type===z.value)),te=t=>{u.value=t,(!t.isPaid||t.unlocked)&&(N.value=N.value+"?t="+Date.now(),M.value=!1)},se=()=>{if(!m.isLoggedIn){_.warning(v("login_warn")),D.push({path:"/login",query:{redirect:L.fullPath}});return}D.push({path:"/checkout",query:{type:"course"}})},le=t=>{r.speed=t,x.value&&(x.value.playbackRate=t)},ae=()=>{const t=localStorage.getItem("video_time_1");t&&parseFloat(t)>5&&(V.value=parseFloat(t),M.value=!0,setTimeout(()=>M.value=!1,8e3))},oe=()=>{x.value.currentTime=V.value,x.value.play(),M.value=!1,_.success(v("player.msg_jumped",{time:Q(V.value)}))},ie=t=>{const s=t.target.currentTime;Math.floor(s)%5===0&&localStorage.setItem("video_time_1",s)},Q=t=>{const s=Math.floor(t/60),c=Math.floor(t%60);return`${s}:${c<10?"0"+c:c}`},ne=()=>{if(!m.isLoggedIn){_.warning(v("login_warn"));return}f.value=!f.value,f.value?(m.favorites.push(1),_.success(v("player.msg_faved"))):_.info(v("player.msg_unfaved"))},re=t=>{G.value=t,navigator.clipboard.writeText(t),_.success(v("player.msg_copied",{char:t}))},de=()=>{let t=0,s=[];A.value.forEach(c=>{S.value[c.id]===c.correct?t+=50:s.push(c.id.toString())}),g.value={score:t,wrongIds:s},t===100&&_.success(v("player.quiz.msg_perfect"))},W=()=>{w.value&&(k.value.push({role:"user",text:w.value}),setTimeout(()=>{k.value.push({role:"ai",text:v("player.ai.mock_reply",{input:w.value})})},800),w.value="")};return(t,s)=>{const c=J("el-skeleton"),ue=J("el-dialog");return i(),o("div",xe,[e("nav",Me,[e("div",Te,[e("a",{class:"navbar-brand text-white fw-bold",onClick:s[0]||(s[0]=K(l=>t.$router.push("/portal"),["prevent"])),href:"#"},a(t.$t("brand")),1),e("div",Se,[e("button",{class:"btn btn-sm btn-warning fw-bold border-0",onClick:s[1]||(s[1]=l=>R(m).toggleDemo())},[s[12]||(s[12]=e("i",{class:"bi bi-magic"},null,-1)),d(" "+a(R(m).isDemo?t.$t("player.nav.demo_exit"):t.$t("player.nav.demo_mode")),1)]),e("button",{onClick:s[2]||(s[2]=l=>t.$router.push("/education")),class:"btn btn-outline-light btn-sm rounded-pill px-3"},[s[13]||(s[13]=e("i",{class:"bi bi-arrow-left"},null,-1)),d(" "+a(t.$t("player.nav.back")),1)]),e("img",{src:R(m).userInfo.avatar||"https://api.dicebear.com/7.x/avataaars/svg?seed=LiHua",class:"nav-avatar border border-white"},null,8,Pe)])])]),j.value?(i(),o("div",ze,[I(c,{rows:15,animated:""})])):(i(),o("div",Ve,[e("div",Be,[e("div",Ie,[e("div",Fe,[u.value.isPaid&&!u.value.unlocked?(i(),o("div",He,[s[14]||(s[14]=e("i",{class:"bi bi-lock-fill",style:{"font-size":"50px","margin-bottom":"15px"}},null,-1)),e("h4",Ee,a(t.$t("player.lock.title")),1),e("p",Ne,a(t.$t("player.lock.desc")),1),e("button",{class:"btn btn-danger rounded-pill px-5 fw-bold",onClick:se},a(t.$t("player.lock.btn_unlock",{price:u.value.price})),1),e("button",Ae,a(t.$t("player.lock.btn_trial")),1)])):(i(),o("div",Re,[e("video",{ref_key:"videoRef",ref:x,class:"real-video",src:N.value,controls:"",poster:"https://images.unsplash.com/photo-1557804506-669a67965ba0?w=800",onTimeupdate:ie,onLoadedmetadata:ae},null,40,Ue),r.showSubtitle?(i(),o("div",De,[r.subMode!=="EN"?(i(),o("p",Le,a(B.cn),1)):C("",!0),r.subMode!=="CN"?(i(),o("p",je,a(B.en),1)):C("",!0)])):C("",!0),I(X,{name:"fade"},{default:F(()=>[M.value?(i(),o("div",{key:0,class:"resume-tip",onClick:oe},[s[15]||(s[15]=e("i",{class:"bi bi-clock-history"},null,-1)),d(" "+a(t.$t("player.resume_tip",{time:Q(V.value)})),1)])):C("",!0)]),_:1})]))]),e("div",Ge,[e("div",Oe,[e("span",qe,[s[16]||(s[16]=e("i",{class:"bi bi-tools"},null,-1)),d(" "+a(t.$t("player.tools.label"))+":",1)]),e("div",Qe,[e("button",We,a(t.$t("player.tools.pinyin"))+": "+a(G.value||t.$t("player.tools.pinyin_ph")),1),e("ul",Ke,[e("li",Xe,a(t.$t("player.tools.pinyin_tip")),1),e("div",Je,[(i(),o(y,null,h(Z,l=>e("button",{key:l,class:"btn btn-sm btn-outline-secondary p-1",style:{width:"30px"},onClick:b=>re(l)},a(l),9,Ye)),64))])])]),e("button",{class:"btn btn-light btn-sm border text-success",onClick:s[3]||(s[3]=l=>E.value=!0)},[s[17]||(s[17]=e("i",{class:"bi bi-pencil-square"},null,-1)),d(" "+a(t.$t("player.tools.quiz")),1)]),e("button",{class:p(["btn btn-sm ms-auto",f.value?"btn-danger text-white":"btn-outline-danger"]),onClick:ne},[e("i",{class:p(f.value?"bi bi-heart-fill":"bi bi-heart")},null,2),d(" "+a(f.value?t.$t("player.tools.faved"):t.$t("player.tools.fav")),1)],2)])]),!u.value.isPaid||u.value.unlocked?(i(),o("div",Ze,[e("div",et,[e("button",tt,a(t.$t("player.ctrl.speed"))+": "+a(r.speed)+"x ",1),e("ul",st,[(i(),o(y,null,h([.5,1,1.25,1.5,2],l=>e("li",{key:l},[e("a",{class:"dropdown-item",href:"#",onClick:K(b=>le(l),["prevent"])},a(l)+"x",9,lt)])),64))])]),e("div",at,[e("button",{class:p(["btn",r.subMode==="CN"?"btn-primary":"btn-outline-primary"]),onClick:s[4]||(s[4]=l=>r.subMode="CN")},a(t.$t("player.ctrl.sub_cn")),3),e("button",{class:p(["btn",r.subMode==="EN"?"btn-primary":"btn-outline-primary"]),onClick:s[5]||(s[5]=l=>r.subMode="EN")},a(t.$t("player.ctrl.sub_en")),3),e("button",{class:p(["btn",r.subMode==="BOTH"?"btn-primary":"btn-outline-primary"]),onClick:s[6]||(s[6]=l=>r.subMode="BOTH")},a(t.$t("player.ctrl.sub_both")),3)]),e("div",ot,[H(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":s[7]||(s[7]=l=>r.showSubtitle=l),id:"subSwitch"},null,512),[[he,r.showSubtitle]]),e("label",it,a(t.$t("player.ctrl.subtitle")),1)])])):C("",!0),e("div",nt,[e("h2",rt,a(u.value.title),1),e("div",dt,[e("span",null,[s[18]||(s[18]=e("i",{class:"bi bi-eye"},null,-1)),d(" 1.2w "+a(t.$t("player.meta.views")),1)]),s[20]||(s[20]=e("span",null,[e("i",{class:"bi bi-star-fill text-warning"}),d(" 4.9")],-1)),e("span",null,[s[19]||(s[19]=e("i",{class:"bi bi-clock"},null,-1)),d(" "+a(u.value.duration),1)])]),s[21]||(s[21]=e("hr",null,null,-1)),e("h5",ut,a(t.$t("player.meta.key_points")),1),e("div",ct,[e("ul",null,[(i(!0),o(y,null,h(O.value,(l,b)=>(i(),o("li",{key:b},a(l),1))),128))])])])]),e("div",pt,[e("div",vt,[e("div",bt,[e("h5",mt,a(t.$t("player.playlist.title")),1),e("div",yt,[(i(),o(y,null,h(["all","grammar","scenario","culture"],l=>e("span",{key:l,class:p(["v-tab",{active:z.value===l}]),onClick:b=>z.value=l},a(t.$t(`player.playlist.tabs.${l}`)),11,ht)),64))])]),e("div",ft,[(i(!0),o(y,null,h(ee.value,l=>(i(),o("div",{key:l.id,class:p(["chapter-item",{active:u.value.id===l.id,locked:l.isPaid&&!l.unlocked}]),onClick:b=>te(l)},[e("div",null,[e("div",_t,a(l.title),1),e("div",wt,[e("i",{class:p(u.value.id===l.id?"bi bi-play-fill text-primary":"bi bi-play-circle")},null,2),d(" "+a(l.duration),1)])]),e("div",kt,[l.isPaid?l.unlocked?(i(),o("span",Ct,a(t.$t("player.tags.unlocked")),1)):(i(),o("span",xt,[s[22]||(s[22]=e("i",{class:"bi bi-lock-fill"},null,-1)),d(" "+a(t.$t("player.tags.paid")),1)])):(i(),o("span",$t,a(t.$t("player.tags.free")),1))])],10,gt))),128))])])])])])),e("div",Mt,[e("button",{class:"btn btn-primary rounded-circle shadow-lg d-flex align-items-center justify-content-center",style:{width:"60px",height:"60px","font-size":"24px"},onClick:s[8]||(s[8]=l=>P.value=!P.value)},[...s[23]||(s[23]=[e("i",{class:"bi bi-robot"},null,-1)])])]),I(X,{name:"slide-up"},{default:F(()=>[H(e("div",Tt,[e("div",St,[e("span",Pt,[s[24]||(s[24]=e("i",{class:"bi bi-robot me-2"},null,-1)),d(a(t.$t("player.ai.title")),1)]),e("button",{type:"button",class:"btn-close btn-close-white btn-sm",onClick:s[9]||(s[9]=l=>P.value=!1)})]),e("div",zt,[(i(!0),o(y,null,h(k.value,(l,b)=>(i(),o("div",{class:"d-flex align-items-start mb-3",key:b},[e("div",{class:p([l.role==="ai"?"bg-white text-dark":"bg-primary text-white ms-auto","p-2 rounded shadow-sm small"]),style:{"max-width":"80%"}},a(l.text),3)]))),128))],512),e("div",Vt,[e("div",Bt,[H(e("input",{type:"text","onUpdate:modelValue":s[10]||(s[10]=l=>w.value=l),onKeyup:we(W,["enter"]),class:"form-control border-0 bg-light",placeholder:t.$t("player.ai.input_ph")},null,40,It),[[ke,w.value]]),e("button",{class:"btn btn-link text-primary",onClick:W},[...s[25]||(s[25]=[e("i",{class:"bi bi-send-fill"},null,-1)])])])])],512),[[$e,P.value]])]),_:1}),I(ue,{modelValue:E.value,"onUpdate:modelValue":s[11]||(s[11]=l=>E.value=l),title:t.$t("player.quiz.title"),width:"90%",style:{"max-width":"500px"}},{footer:F(()=>[e("div",Nt,[g.value?(i(),o("span",At,a(t.$t("player.quiz.score"))+": "+a(g.value.score),1)):C("",!0),e("button",{class:"btn btn-primary",onClick:de,disabled:!!g.value},a(t.$t("player.quiz.btn_submit")),9,Rt)])]),default:F(()=>[(i(!0),o(y,null,h(A.value,(l,b)=>(i(),o("div",{key:l.id,class:"mb-4"},[e("p",Ft,a(b+1)+". "+a(l.title),1),e("div",Ht,[(i(!0),o(y,null,h(l.options,$=>(i(),o("label",{key:$.val,class:p(["p-2 border rounded cursor-pointer quiz-opt",{"bg-primary text-white":S.value[l.id]===$.val,"bg-danger text-white":g.value&&g.value.wrongIds.includes(l.id.toString())&&S.value[l.id]===$.val,"bg-success text-white":g.value&&l.correct===$.val}])},[H(e("input",{type:"radio",name:"q"+l.id,value:$.val,"onUpdate:modelValue":ce=>S.value[l.id]=ce,class:"d-none"},null,8,Et),[[Ce,S.value[l.id]]]),d(" "+a($.label),1)],2))),128))])]))),128))]),_:1},8,["modelValue","title"])])}}},jt=pe(Ut,[["__scopeId","data-v-afd1b454"]]);export{jt as default};
